package org.fkit.hellotest;

public class RabinKarpTest {
	public static void main(String[] args) {
		String haystack = "hello";
		String needle = "ll";
		RabinKarpTest rk = new RabinKarpTest();
		System.out.println(rk.strStr(haystack, needle));
	}

	public int strStr(String haystack, String needle) {
        int len = needle.length();
        int len1 = haystack.length();
        int patternCode = hashcode(needle);
        int start = 0;
        do{
            int currentCode = (start == 0) ? hashcode(haystack.substring(start, len)) : nextCode(start, haystack, len, patternCode);
            if(patternCode == currentCode && needle.equals(haystack.substring(start,len))) {
                return start;
            }
            start++;
        } while(start+len<len1);
        return -1;
    }
    
    public int hashcode(String str) {
        int code = 0;
        for(int i = 0; i < str.length(); i++) {
            code += (int)(str.charAt(i)-'a')+1;
        }
        return code;
    }
    
    public int nextCode(int start, String haystack, int len, int oldCode) {
        return oldCode + (int)(haystack.charAt(start+len)-haystack.charAt(start));
    }
}
